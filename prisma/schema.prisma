// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

// Looking for ways to speed up your queries, or scale easily with your serverless or edge functions?
// Try Prisma Accelerate: https://pris.ly/cli/accelerate-init

generator client {
  provider = "prisma-client"
  output   = "../app/generated/prisma"
}

datasource db {
  provider = "postgresql"
}

model Alternatif {
  id        Int       @id @default(autoincrement())
  nama      String
  detail    String?
  createdAt DateTime  @default(now())
  
  // PENGGANTI USER ID: Session ID (dari Cookie browser)
  sessionId String    @db.VarChar(255) 
  
  matriks   Matriks[]
  
  // Index biar query cepat saat filter session
  @@index([sessionId])
}
// Model Kriteria: Definisi parameter penilaian
model Kriteria {
  id          Int       @id @default(autoincrement())
  kode        String    @unique
  nama        String
  tipe        String
  bobot       Float     // Ini bobot default saja
  aktif       Boolean   @default(true) // HANYA SEBAGAI DEFAULT. Status real ada di LocalStorage
  isSystem    Boolean   @default(false)
  isDropdown  Boolean   @default(false)
  options     String?
  
  // FIELD BARU: Agar kriteria custom tidak muncul di user lain
  sessionId   String?   

  matriks     Matriks[]
}

model Matriks {
  id           Int        @id @default(autoincrement())
  nilai        Float
  
  alternatifId Int
  alternatif   Alternatif @relation(fields: [alternatifId], references: [id], onDelete: Cascade)
  
  kriteriaId   Int
  kriteria     Kriteria   @relation(fields: [kriteriaId], references: [id], onDelete: Cascade)

  @@unique([alternatifId, kriteriaId])
}